<!DOCTYPE html>
<html lang="fa">
  <head>
    <meta charset="UTF-8" />
    <title>Ø±Ø§Ø² Ù‚Ù„Ø¨ÛŒ Ù…Ø±Ø­Ù„Ù‡â€ŒØ§ÛŒ</title>
    <style>
      body {
        font-family: "Tahoma", sans-serif;
        background: linear-gradient(to bottom, #fff0f5, #ffe4e1);
        text-align: center;
        padding: 50px 20px;
        margin: 0;
        overflow-x: hidden;
      }
      #heart {
        position: fixed;
        top: 20px;
        left: 20px;
        font-size: 50px;
        color: #e91e63;
        user-select: none;
        cursor: default;
        z-index: 1000;
        transition: transform 0.3s ease;
      }
      button,
      input {
        padding: 10px 20px;
        font-size: 16px;
        border-radius: 10px;
        margin: 10px;
        border: none;
      }
      button {
        background-color: #ec407a;
        color: white;
        cursor: pointer;
        transition: background-color 0.3s ease;
      }
      button:hover {
        background-color: #c2185b;
      }
      #countdown {
        font-size: 22px;
        color: #ad1457;
        margin: 20px 0 40px 0;
      }
      .stage {
        display: none;
        max-width: 600px;
        margin: auto;
        background-color: #fce4ec;
        padding: 25px 30px;
        border-radius: 15px;
        font-size: 18px;
        color: #880e4f;
        white-space: pre-wrap;
      }
      input[type="text"] {
        width: 80%;
        font-size: 17px;
        border: 1px solid #c2185b;
        border-radius: 8px;
        padding: 8px 12px;
        outline: none;
        color: #4a148c;
      }
      #error {
        color: red;
        margin-top: 12px;
        font-weight: bold;
      }
    </style>
  </head>
  <body>
    <div id="heart">â¤ï¸</div>

    <!-- Ù…Ø±Ø­Ù„Ù‡ 1: ØªØ§ÛŒÙ…Ø± -->
    <div id="timerStage" class="stage" style="display: block">
      <h1>ğŸ ÛŒÙ‡ Ø±Ø§Ø² Ù‚Ù„Ø¨ÛŒ Ø¨Ø¹Ø¯ Ø§Ø² Û¶ Ù…Ø§Ù‡</h1>
      <p>ØµØ¨Ø± Ú©Ù† ØªØ§ Ø²Ù…Ø§Ù†Ø´ Ø¨Ø±Ø³Ù‡...</p>
      <div id="countdown">Ø¯Ø± Ø­Ø§Ù„ Ø¨Ø§Ø±Ú¯Ø°Ø§Ø±ÛŒ...</div>
      <button onclick="activate()">ÙØ¹Ø§Ù„Ø³Ø§Ø²ÛŒ ØªØ§ÛŒÙ…Ø±</button>
    </div>

    <!-- Ù…Ø±Ø­Ù„Ù‡ 2: Ø³ÙˆØ§Ù„ Ø¨Ù‡ØªØ± ÛŒØ§ Ø¨Ø¯ØªØ± -->
    <div id="questionStage" class="stage">
      <p>Ø¨Ù‡ Ù†Ø¸Ø±Øª Ø±Ø§Ø¨Ø·Ù‡â€ŒÙ…ÙˆÙ† ØªÙˆ Ø§ÛŒÙ† Û¶ Ù…Ø§Ù‡ Ø¨Ù‡ØªØ± Ø´Ø¯Ù‡ ÛŒØ§ Ø¨Ø¯ØªØ±ØŸ</p>
      <button onclick="answerRelation(true)">Ø¨Ù‡ØªØ± Ø´Ø¯Ù‡ â¤ï¸</button>
      <button onclick="answerRelation(false)">Ø¨Ø¯ØªØ± Ø´Ø¯Ù‡ ğŸ’”</button>
    </div>

    <!-- Ù…Ø±Ø­Ù„Ù‡ 3: Ø³ÙˆØ§Ù„ ØªÛŒÚ©Ù‡ Ú©Ù„Ø§Ù… -->
    <div id="phraseStage" class="stage">
      <p>ØªÛŒÚ©Ù‡â€ŒÚ©Ù„Ø§Ù… Ù…Ù† Ú†ÛŒ Ø¨ÙˆØ¯ØŸ</p>
      <input type="text" id="answer" placeholder="" autocomplete="off" />
      <br />
      <button onclick="checkAnswer()">Ø¨Ø±Ø±Ø³ÛŒ Ø¬ÙˆØ§Ø¨</button>
      <div id="error"></div>
    </div>

    <!-- Ù…Ø±Ø­Ù„Ù‡ 4: Ù¾ÛŒØ§Ù… Ù†Ù‡Ø§ÛŒÛŒ -->
    <div id="resultStage" class="stage"></div>

    <script>
      const key = "activationDate6MonthKey";
      const heart = document.getElementById("heart");
      let relationBetter = null; // Ø°Ø®ÛŒØ±Ù‡ Ø¬ÙˆØ§Ø¨ Ø³ÙˆØ§Ù„ Ø±Ø§Ø¨Ø·Ù‡

      function showStage(stageId) {
        document.querySelectorAll(".stage").forEach((stage) => {
          stage.style.display = "none";
        });
        document.getElementById(stageId).style.display = "block";
      }

      function activate() {
        if (!localStorage.getItem(key)) {
          const now = new Date();
          localStorage.setItem(key, now.toISOString());
          alert("ØªØ§ÛŒÙ…Ø± ÙØ¹Ø§Ù„ Ø´Ø¯! Û¶ Ù…Ø§Ù‡ Ø¯ÛŒÚ¯Ù‡ Ø¨Ø±Ú¯Ø±Ø¯ ğŸ˜‰");
        } else {
          alert("ØªØ§ÛŒÙ…Ø± Ù‚Ø¨Ù„Ø§Ù‹ ÙØ¹Ø§Ù„ Ø´Ø¯Ù‡.");
        }
        checkTime();
      }

      function checkTime() {
        const saved = localStorage.getItem(key);
        const countdownEl = document.getElementById("countdown");
        if (!saved) {
          countdownEl.textContent = "Ù„Ø·ÙØ§ ØªØ§ÛŒÙ…Ø± Ø±Ø§ ÙØ¹Ø§Ù„ Ú©Ù†ÛŒØ¯.";
          return;
        }
        const start = new Date(saved);
        const target = new Date(start);
        target.setMonth(target.getMonth() + 0);

        const interval = setInterval(() => {
          const now = new Date();
          const distance = target - now;

          if (distance <= 0) {
            clearInterval(interval);
            countdownEl.textContent = "â³ Ø²Ù…Ø§Ù† ØªÙ…ÙˆÙ… Ø´Ø¯!";
            showStage("questionStage");
          } else {
            const days = Math.floor(distance / (1000 * 60 * 60 * 24));
            const hours = Math.floor((distance / (1000 * 60 * 60)) % 24);
            const minutes = Math.floor((distance / (1000 * 60)) % 60);
            const seconds = Math.floor((distance / 1000) % 60);
            countdownEl.textContent = `Ù…Ø§Ù†Ø¯Ù‡: ${days} Ø±ÙˆØ²ØŒ ${hours} Ø³Ø§Ø¹ØªØŒ ${minutes} Ø¯Ù‚ÛŒÙ‚Ù‡ØŒ ${seconds} Ø«Ø§Ù†ÛŒÙ‡`;
          }
        }, 1000);
      }

      function answerRelation(better) {
        relationBetter = better; // Ø°Ø®ÛŒØ±Ù‡ Ø¬ÙˆØ§Ø¨
        showStage("phraseStage"); // Ù‡Ù…ÛŒØ´Ù‡ Ù…Ø±Ø­Ù„Ù‡ ØªÛŒÚ©Ù‡ Ú©Ù„Ø§Ù… Ø¨ÛŒØ§Ø¯
      }

      function checkAnswer() {
        const answerInput = document.getElementById("answer");
        const userAnswer = answerInput.value.trim();
        const correctAnswer = "Ù‚Ù„Ø¨ Ù…Ù†ÛŒ";
        const errorEl = document.getElementById("error");
        errorEl.textContent = "";

        if (userAnswer.toLowerCase() === correctAnswer.toLowerCase()) {
          let finalText = "";
          if (relationBetter) {
            // Ø§Ú¯Ø± Ø¨Ù‡ØªØ± Ø¨ÙˆØ¯ Ù¾ÛŒØ§Ù… ØºÙ…Ú¯ÛŒÙ†
            finalText = `Ø§ÛŒÙ† Ø§Ø´ØªØ¨Ø§Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ø§ Ù…Ù‚Ø¯Ø³Ù‡
Ù†Ù…ÛŒØ¯ÙˆÙ†Ù… Ù‡Ù†ÙˆØ² Ø¨Ø§ Ù…Ù† Ù‡Ø³ØªÛŒ ÛŒØ§ Ù†Ù‡
ÙˆÙ„ÛŒ Ø§ÛŒÙ†Ùˆ Ù…Ù† Ø¨Ø±Ø§ÛŒ ØªÙˆ ÙÙ‚Ø· Ø¯Ø±Ø³Øª Ú©Ø±Ø¯Ù…
Ù†Ú¯Ù‡Ø´ Ø¯Ø§Ø± Ø¨Ø±Ø§ Ø®ÙˆØ¯Øª
Ø¨Ø¯ÙˆÙ† Ú©Ù‡ Ø®ÛŒÙ„ÛŒ Ø¨Ù‡ ÙÚ©Ø±Øª Ø¨ÙˆØ¯Ù…
ÙˆÙ„ÛŒ Ø§ÛŒÙ† Ù†Ø¨ÙˆØ¯ Ø¬ÙˆØ§Ø¨ Ù…Ù†
Ú©Ø§Ø´ Ø¨Ù‡ØªØ± Ø±ÙØªØ§Ø± Ù…ÛŒÚ©Ø±Ø¯ÛŒ Ù†Ù…ÛŒØ¯ÙˆÙ†Ù… Ø´Ø§ÛŒØ¯ Ø®Ø§Ø·Ø±Ø§Øª Ø®ÙˆØ¨ÛŒ Ø±Ùˆ Ø¨Ø§ Ù‡Ù… Ø¯Ø§Ø´ØªÛŒÙ… 
ÛŒØ§ Ø´Ø§ÛŒØ¯ Ø¨Ø¯ ÙˆÙ„ÛŒ Ø§ÛŒÙ†Ùˆ Ø¨Ø¯ÙˆÙ† Ù‡Ù…ÛŒÙ† Ù‚Ø¯Ø± Ù‡Ù… Ù¾ÛŒØ§Ù… Ù…ÛŒØ¯ÛŒ Ú©Ø§ÙÛŒ Ø¨ÙˆØ¯ 
ØªÙˆ Ø²Ù†Ø¯Ú¯ÛŒÙ… Ø§Ø¯Ù…ÛŒØ¨ÙˆØ¯Ù… Ú©Ù‡ Ø²ÛŒØ§Ø¯ Ø³Ø®ØªÛŒ Ú©Ø´ÛŒØ¯Ù… 
Ù‡Ø± Ú†ÛŒ Ú©Ù‡ ÙÚ©Ø± Ú©Ù†ÛŒ Ø¨Ø±Ø§ Ù‡Ù…ÛŒÙ† Ø¨ÙˆØ¯ Ú©Ù‡ Ø§ÛŒÙ†Ù‚Ø¯Ø± Ø²ÙˆØ¯ Ù…ÛŒØ´Ú©Ø³ØªÙ…`;
          } else {
            // Ø§Ú¯Ø± Ø¨Ø¯ØªØ± Ø¨ÙˆØ¯ Ù¾ÛŒØ§Ù… Ø¹Ø§Ø´Ù‚Ø§Ù†Ù‡
            finalText = `ğŸ‰ Ø¢ÙØ±ÛŒÙ†!
ØªÙˆ Ù†Ù‡â€ŒØªÙ†Ù‡Ø§ ÛŒØ§Ø¯Øª Ø¨ÙˆØ¯ØŒ Ø¨Ù„Ú©Ù‡ Ù†Ø´ÙˆÙ† Ø¯Ø§Ø¯ÛŒ Ú†Ù‚Ø¯Ø± Ø¨Ø±Ø§Øª Ù…Ù‡Ù…Ù….
Ø§ÛŒÙ† Û¶ Ù…Ø§Ù‡ ÙÙ‚Ø· Ø¨Ø§Ø¹Ø« Ø´Ø¯ Ø¨ÛŒØ´ØªØ± Ù‚Ø¯Ø± ØªÙˆ Ø±Ùˆ Ø¨Ø¯ÙˆÙ†Ù….
ØªÙˆ Ù‡Ù…ÛŒØ´Ù‡ Ø¨Ø±Ø§ÛŒ Ù…Ù† Ø®Ø§Øµ Ø¨ÙˆØ¯ÛŒ Ùˆ Ø®ÙˆØ§Ù‡ÛŒ Ø¨ÙˆØ¯. â¤ï¸`;
          }
          document.getElementById("resultStage").textContent = finalText;
          showStage("resultStage");
        } else {
          errorEl.textContent = "Ø¬ÙˆØ§Ø¨ Ø§Ø´ØªØ¨Ø§Ù‡Ù‡! ÛŒÚ©Ù… ÙÚ©Ø± Ú©Ù†... â¤ï¸";
        }
      }

      // Ø§Ù†ÛŒÙ…ÛŒØ´Ù† Ù‚Ù„Ø¨ Ø¯Ø± Ø§Ø³Ú©Ø±ÙˆÙ„
      let ticking = false;
      window.addEventListener("scroll", () => {
        if (!ticking) {
          window.requestAnimationFrame(() => {
            heart.style.animation = "bounce 0.6s";
            setTimeout(() => (heart.style.animation = ""), 600);

            if (navigator.vibrate) {
              navigator.vibrate(200);
            }

            ticking = false;
          });
          ticking = true;
        }
      });

      window.onload = () => {
        checkTime();
      };
    </script>
  </body>
</html>
